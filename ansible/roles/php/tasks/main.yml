---
- name: Install REMI repo
  yum: name=http://rpms.famillecollet.com/enterprise/remi-release-7.rpm state=present

- name: Enable REMI repo
  copy: src=remi.repo dest=/etc/yum.repos.d/remi.repo

- name: Install php5-cli
  sudo: yes
  yum: pkg=php-cli state=present enablerepo=remi

- name: Ensure timezone is set in cli php.ini
  lineinfile: dest=/etc/php.ini regexp='date.timezone =' line='date.timezone = {{ timezone }}'

- name: Install php-fpm
  sudo: yes
  yum: pkg=php-fpm state=present enablerepo=remi

- name: Install PHP Packages
  sudo: yes
  yum: pkg={{ item }} state=present enablerepo=remi
  with_items: php.packages

- name: Create PHP session directory
  shell: mkdir /var/lib/php/session creates=/var/lib/php/session

- name: Configure XDebug
  copy: src=xdebug.ini dest=/etc/php.d/15-xdebug.ini
  notify: Restart php-fpm

